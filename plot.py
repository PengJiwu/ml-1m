import numpy as np
import matplotlib.pyplot as plt

# collrank method on jaina server
# iteration, training time (sec), objective function, pairwise error, ndcg@10
c = [
[0, 0.014735, 25489567.109231, 0.355658, 0.468591],
[1, 16.892573, 18519026.187900, 0.204937, 0.745894],
[1, 33.221433, 18069956.422361, 0.204722, 0.746035],
[2, 50.128053, 18014943.473144, 0.202644, 0.747400],
[2, 66.497577, 18004000.359596, 0.202337, 0.748291],
[3, 83.412850, 17988744.087084, 0.201049, 0.751346],
[3, 99.798190, 17948506.793723, 0.198984, 0.758108],
[4, 116.716384, 17867821.274828, 0.194814, 0.767225],
[4, 133.106262, 17798861.389770, 0.191634, 0.770586],
[5, 150.020848, 17766457.377823, 0.190082, 0.773864],
[5, 166.411250, 17747269.367273, 0.188791, 0.777522],
[6, 183.331421, 17723048.249093, 0.187362, 0.781496],
[6, 199.731190, 17700714.419004, 0.185651, 0.785418],
[7, 216.647259, 17682730.613125, 0.184441, 0.787329],
[7, 233.041012, 17671409.991850, 0.183419, 0.790336],
[8, 249.961556, 17663591.455516, 0.182686, 0.791529],
[8, 266.355584, 17658846.337208, 0.182133, 0.794073],
[9, 283.272990, 17655083.799491, 0.181730, 0.794851],
[9, 299.676662, 17652290.083164, 0.181401, 0.796904],
[10, 316.602264, 17649984.025291, 0.181216, 0.797105],
[10, 332.993033, 17648196.494419, 0.181112, 0.797729],
[11, 349.906869, 17646706.703332, 0.181017, 0.797382],
[11, 366.302834, 17645471.715662, 0.180868, 0.797659],
[12, 383.222621, 17644389.634194, 0.180768, 0.798134],
[12, 399.615958, 17643465.959939, 0.180671, 0.798149],
[13, 416.528813, 17642671.961020, 0.180642, 0.797910],
[13, 432.922998, 17642011.568892, 0.180551, 0.798362],
[14, 449.839613, 17641462.218549, 0.180488, 0.798491],
[14, 466.232712, 17641014.028753, 0.180444, 0.798577],
[15, 483.148988, 17640642.824327, 0.180366, 0.798632],
[15, 499.543904, 17640336.646133, 0.180326, 0.798865],
[16, 516.478109, 17640077.621669, 0.180343, 0.798900],
[16, 532.886697, 17639857.941769, 0.180318, 0.798868],
[17, 549.811814, 17639667.063538, 0.180283, 0.798940],
[17, 566.206390, 17639501.049027, 0.180241, 0.798881],
[18, 583.125438, 17639354.398071, 0.180225, 0.798886],
[18, 599.517975, 17639225.077956, 0.180235, 0.799036],
[19, 616.435123, 17639110.240045, 0.180217, 0.798933],
[19, 632.846246, 17639008.527284, 0.180215, 0.798890],
[20, 649.776891, 17638918.097401, 0.180183, 0.798896],
[20, 666.186721, 17638837.803709, 0.180170, 0.798946]
]


# our method
w = [
[0, 0.0, 3.4923972344709754e7, 0.3510205089577718, 0.4753335862187586],
[1, 5.404495991, 2.065018648247157e7, 0.23643604844121305, 0.733801658808334],
[2, 13.157176458, 1.7919937083181847e7, 0.1927016951718535, 0.7781138146180607],
[3, 21.794671909999998, 1.7707365601119094e7, 0.18474258794462156, 0.7910377289550884],
[4, 31.191586211999997, 1.7663148705281977e7, 0.18201973339141664, 0.796294944993741],
[5, 40.481112157, 1.764978595047792e7, 0.1809857839424875, 0.7980915688394775],
[6, 49.037793070999996, 1.7644575966865093e7, 0.18045180573422978, 0.7994476981028341],
[7, 57.55204594199999, 1.7642084638151847e7, 0.1802438940370599, 0.7994307352179486],
[8, 65.458979906, 1.764072544686018e7, 0.1801828890743176, 0.7995226071699875],
[9, 73.208389966, 1.7639913387628738e7, 0.18009714037256452, 0.7994483908820548],
[10, 80.294948716, 1.7639394567674518e7, 0.18006125722267952, 0.7995192587547784],
[11, 88.105937594, 1.7639045468658887e7, 0.18004377492931398, 0.7993668362434537],
[12, 95.203428217, 1.7638800772987466e7, 0.1800488808296141, 0.7993365503582156],
[13, 102.360926936, 1.763862346178225e7, 0.18003996064359473, 0.7992946859162385],
[14, 109.487465488, 1.763849138721964e7, 0.18002141814511022, 0.7993777123325684],
[15, 116.598755058, 1.763839069198585e7, 0.1800447959942229, 0.7993090974153798],
[16, 123.699118141, 1.7638312377446912e7, 0.18005663149272694, 0.7992865959409045],
[17, 130.737638285, 1.7638250413392056e7, 0.18006222649187578, 0.7992638469850094],
[18, 137.753362335, 1.7638200646258056e7, 0.18006452751016358, 0.7994079770398347],
[19, 144.73587923, 1.7638160146403465e7, 0.180072617302539, 0.799448248521254],
[20, 151.687364252, 1.763812680276606e7, 0.1800671486306438, 0.7994139929314301],
]
c = np.array(c)
w = np.array(w)
plt.plot(w[:,1], w[:,4], 'r--', c[:,1], c[:,4])
plt.ylim(0, 1)
plt.title('NDCG')
plt.show()

plt.plot(w[:,1], w[:,3], 'r--', c[:,1], c[:,3])
plt.ylim(0, 1)
plt.title('pairwise_error')
plt.show()

plt.plot(w[:,1], w[:,2], 'r--', c[:,1], c[:,2])
plt.title('objective_function')
plt.show()








# four cores
julia> main(x, y, v, xx, yy, vv)
iter time objective_function pairwise_error NDCG
[0, 0.0, 3.492397234470954e7, 0.3510205089577718, 0.4753335862187586],
  1.678660 seconds (10.24 M allocations: 4.518 GB, 12.16% gc time)
  0.499530 seconds (11.39 k allocations: 961.703 KB)
[1, 5.616720384, 1.791993708318427e7, 0.1927016951718535, 0.7781138146180607],
  2.982273 seconds (16.28 M allocations: 8.691 GB, 10.66% gc time)
  0.917599 seconds (11.39 k allocations: 961.703 KB)
[2, 13.724786791, 1.7663148705284577e7, 0.18201973339141664, 0.796294944993741],
  3.274904 seconds (17.80 M allocations: 9.734 GB, 10.48% gc time)
  0.699746 seconds (11.40 k allocations: 978.344 KB)
[3, 21.600646521999998, 1.7644575966866747e7, 0.18045180573422978, 0.7994476981028341],
  2.958819 seconds (16.28 M allocations: 8.691 GB, 10.47% gc time)
  0.656847 seconds (11.39 k allocations: 961.703 KB)
[4, 28.720281531999998, 1.7640725446861226e7, 0.1801828890743176, 0.7995226071699875],
  2.625300 seconds (14.77 M allocations: 7.647 GB, 10.36% gc time)
  0.683220 seconds (11.39 k allocations: 977.781 KB)
[5, 35.103232981, 1.763939456767286e7, 0.18006125722267952, 0.7995192587547784],
  2.634530 seconds (14.77 M allocations: 7.647 GB, 10.38% gc time)
  0.609187 seconds (11.40 k allocations: 962.266 KB)
[6, 41.305171267, 1.7638800772988353e7, 0.1800488808296141, 0.7993365503582156],
  2.318446 seconds (13.25 M allocations: 6.604 GB, 10.48% gc time)
  0.605013 seconds (11.39 k allocations: 961.703 KB)



# one core
  julia> main(x, y, v, xx, yy, vv)
iter time objective_function pairwise_error NDCG
[0, 0.0, 3.4923972344709754e7, 0.3510205089577718, 0.4753335862187586],
  1.658891 seconds (10.22 M allocations: 4.517 GB, 10.89% gc time)
  1.288036 seconds (9.51 M allocations: 3.386 GB, 12.01% gc time)
[1, 7.214805126, 1.7919937083181847e7, 0.1927016951718535, 0.7781138146180607],
  2.996044 seconds (16.28 M allocations: 8.691 GB, 11.20% gc time)
  1.871123 seconds (14.39 M allocations: 5.007 GB, 10.21% gc time)
[2, 17.261449234, 1.7663148705281977e7, 0.18201973339141664, 0.796294944993741],
  3.303623 seconds (17.80 M allocations: 9.734 GB, 11.21% gc time)
  1.812775 seconds (14.38 M allocations: 5.004 GB, 10.29% gc time)
[3, 27.128495549, 1.7644575966865093e7, 0.18045180573422978, 0.7994476981028341],
  2.952243 seconds (16.28 M allocations: 8.691 GB, 10.87% gc time)
  1.734848 seconds (13.31 M allocations: 4.648 GB, 10.01% gc time)
[4, 36.183659024, 1.764072544686018e7, 0.1801828890743176, 0.7995226071699875],
  2.638789 seconds (14.77 M allocations: 7.647 GB, 10.75% gc time)
  1.676698 seconds (12.74 M allocations: 4.459 GB, 10.19% gc time)
[5, 44.441139823, 1.7639394567674518e7, 0.18006125722267952, 0.7995192587547784],
  2.646855 seconds (14.77 M allocations: 7.647 GB, 10.84% gc time)
  1.665434 seconds (12.45 M allocations: 4.363 GB, 10.35% gc time)
[6, 52.718880462, 1.7638800772987466e7, 0.1800488808296141, 0.7993365503582156],
  2.299481 seconds (13.25 M allocations: 6.604 GB, 10.47% gc time)
  1.655629 seconds (12.29 M allocations: 4.308 GB, 10.23% gc time)
